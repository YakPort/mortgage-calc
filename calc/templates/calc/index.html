
{% load widget_tweaks %}
{% load humanize %}
{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Hello, world!</title>
  </head>
  <body>

	<div class="container">
	<br><br>
		<div class="row">
		<div class="col-sm-4">
		<form method="get">		
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="price" class="form-control" placeholder="Price" aria-expanded="false" required id="id_price" />
			<div class="collapse" id="price-collapse" name="price">
			  <div class="card card-body">
				  <p>Total <strong>price</strong> of the home in dollars, <i>excluding</i> closing costs, appraisals, etc.</p>
			  </div>
			</div>
			</div>
		  </div>
			
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="closing_cost" min="0" max="1" step="0.01" class="form-control" placeholder="Closing Costs %" required id="id_closing_cost" />
			<div class="collapse" id="price-collapse" name="closing_cost">
			  <div class="card card-body">
				  <p>Closing costs (appraisals, loan origination fees, etc.) as a percent of the home price. This typically ranges 2-5%.</p>
			  </div>
			</div>		
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="maintenance_cost" min="0" max="1" step="0.01" class="form-control" placeholder="Maintenance Costs %" required id="id_maintenance_cost" />
			<div class="collapse" id="price-collapse" name="maintenance_cost">
			  <div class="card card-body">
				  <p>Yearly maintenance costs (lawncare, plumbing, etc.) per year as a percent of the home price. This is typically at least 1% of the home value.</p>
			  </div>
			</div>			
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="property_tax" min="0" max="1" step="0.01" class="form-control" placeholder="Property Tax %" required id="id_property_tax" />
			<div class="collapse" id="price-collapse" name="property_tax">
			  <div class="card card-body">
				  <p>Yearly property taxes as a percent of home price. This varies between state and municipality, but is typically 1-2% of the home value. </p>
			  </div>
			</div>				
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="down_payment" min="0" max="1" step="0.01" class="form-control" placeholder="Down Payment %" required id="id_down_payment" />
			<div class="collapse" id="price-collapse" name="down_payment">
			  <div class="card card-body">
				  <p>Down payment percent of the purchase price. Most banks require at least 20% or private mortgage insurance is triggered. A higher down payment means a lower monthly mortgage payment. However, if the appreciation of the home is greater than the interest rate, a lower down payment increases the investment returns.</p>
			  </div>
			</div>			
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="interest_rate" min="0" max="1" step="0.01" class="form-control" placeholder="Interest Rate %" required id="id_interest_rate" />
			<div class="collapse" id="price-collapse" name="interest_rate">
			  <div class="card card-body">
				  <p>Yearly mortgage interest rate. This is best thought of as the cost of 'renting' the money that you are borrowing. The higher the interest rate, the greater the loan payment each month and the lower the returns.</p>
			  </div>
			</div>				
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="yearly_appreciation" min="0" max="1" step="0.01" class="form-control" placeholder="Yearly Appreciation %" required id="id_yearly_appreciation" />
			<div class="collapse" id="price-collapse" name="yearly_appreciation">
			  <div class="card card-body">
				  <p>Yearly appreciation of the home value. This varies widely by market and timing.</p>
			  </div>
			</div>			
			</div>
		  </div>
		
		  <div class="form-group row">
			<div class="col-sm-12">
			<input type="number" name="alternative_rent" min="0" class="form-control" placeholder="Alternative Rent" required id="id_alternative_rent" />
			<div class="collapse" id="price-collapse" name="alternative_rent">
			  <div class="card card-body">
				  <p>Alternative rent is the cost of the rent you would pay if you do not buy -- your current rent is a good proxy.</p>
			  </div>
			</div>			
			</div>
		  </div>
		
	
	<div class="form-group row">
		<div class="col-sm-12">
		
      <button class="btn btn-info" id="calculate">
        Calculate
      </button>
		</div>
    </div>
  </form>
</div>
<div class="col-sm-8">
	<div id="takeaways" class="row p-3 mb-2 bg-secondary text-white" style="display:none;">
	<p><strong>Investment returns: </strong>The returns for this investment are below and take all cash flows (mortgage, maintenance, rent you don't have to pay, etc.) into account. As a reference, the long run annualized return of the S&P500 is ~9% with reinvested dividends.<br>	
	<ul>Year 5: <span id="year_5_irr"></span><br>
	Year 10: <span id="year_10_irr"></span><br>
	Year 20: <span id="year_20_irr"></span><br>
	Year 30: <span id="year_30_irr"></span></ul>
	Note that, even if your return is higher than the stock market, a house has other issues, namely that 1) it's not diversified -- your fortunes are tied a single property in a single asset class versus a broad collection of stocks and 2) it's illiquid (try selling half of your house to free up some cash).</p>
	<p>Year <span id="first_year_ppmt_greater_than_ipmt"></span> 
		is the first year when your <strong>principal payment will be larger
		than your interest payment.</strong> In other words, every year before that more 
		of your mortgage payment goes to the bank than to the equity in your house.</p>
	</div>
</div>
</div>
		
<table class="table table-sm">
  <thead>
    <tr>
      <th scope="col">Period</th>
		<th scope="col">Principal Paid</th>
		<th scope="col">Interest Paid</th>
		<th scope="col">Other Costs</th>
		<th scope="col">Avoided Rent</th>
		<th scope="col">Total Spend</th>
		<th scope="col">Home Value</th>
		<th scope="col">Debt</th>
		<th scope="col">Equity</th>
      <th scope="col">IRR % (if sold)</th>
    </tr>
  </thead>
  <tbody id="tbody" name="tbody">
    {% for stream in cash_stream %}
	  <tr name="whatever">
      	  <th name="year" scope="row">{{ stream.year }}</th>
		  <td name="principal-payment">{{ stream.principal_payment|floatformat:"0"|intcomma }}</td>
		  <td name="debt-payment">{{ stream.debt_payment|floatformat:"0"|intcomma }}</td>
		  <td name="other-costs">{{ stream.other_costs|floatformat:"0"|intcomma }}</td>
		  <td name="saved-rent">{{ stream.saved_rent|floatformat:"0"|intcomma }}</td>
		  <td name="total">{{ stream.total|floatformat:"0"|intcomma }}</td>
		  <td name="value">{{ stream.value|floatformat:"0"|intcomma }}</td>
		  <td name="debt">{{ stream.debt|floatformat:"0"|intcomma }}</td>
		  <td name="equity">{{ stream.equity|floatformat:"0"|intcomma }}</td>
          <td name="irr">{{ stream.irr|floatformat:2 }}</td>
    </tr>
	{% endfor %}
  </tbody>
</table>
		
  </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	  
	<script src="{% static "calc/js/form-select.js" %}"></script>
	<script src="{% static "calc/js/get-stream.js" %}"></script>
	  
  </body>
</html>